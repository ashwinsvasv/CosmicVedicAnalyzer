<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Vedic Astrology Analyzer</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&family=Cormorant+Garamond:wght@300;400;500;600;700&display=swap">
    <!-- AOS Animation Library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <!-- Chart.js for visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Particles.js for cosmic background -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <style>
        :root {
            --primary-color: #2c0054;
            --secondary-color: #5e0b9e;
            --accent-color: #9b59b6;
            --light-accent: #e1bee7;
            --dark-accent: #4a148c;
            --bg-color: #0c0015;
            --text-color: #f5f5f5;
            --text-secondary: #cbb9d9;
            --card-bg: rgba(25, 5, 48, 0.85);
            --card-border: rgba(158, 90, 200, 0.4);
            --success-color: #4CAF50;
            --error-color: #ff3e5e;
            --gold: #ffd700;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }

        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #ffffff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 40px 70px, #ffffff, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 90px 40px, #ffffff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 160px 120px, #ffffff, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 230px 180px, #ffffff, rgba(0,0,0,0));
            background-repeat: repeat;
            background-size: 300px 300px;
            animation: twinkling 8s infinite linear;
        }

        @keyframes twinkling {
            from { background-position: 0 0; }
            to { background-position: -300px 300px; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            padding: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--accent-color), var(--light-accent), var(--gold));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            position: relative;
            display: inline-block;
        }

        h1::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--gold), transparent);
        }

        h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.2rem;
            color: var(--light-accent);
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }

        h2::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, var(--accent-color), transparent);
        }

        h3 {
            font-size: 1.5rem;
            color: var(--gold);
            margin: 20px 0 10px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 5px;
        }

        .cosmic-card {
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
            padding: 30px;
            margin-bottom: 30px;
            transition: all 0.3s ease-in-out;
            position: relative;
            overflow: hidden;
        }

        .cosmic-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, var(--secondary-color), var(--accent-color), var(--secondary-color));
        }

        .cosmic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(155, 89, 182, 0.2);
        }

        .zodiac-symbol {
            font-size: 1.5rem;
            margin-right: 8px;
            color: var(--gold);
        }

        .planet-list, .sign-list, .cluster-list, .feature-list {
            list-style-type: none;
            padding: 0;
            margin: 15px 0;
        }

        .planet-list li, .sign-list li, .cluster-list li, .feature-list li {
            padding: 10px 15px;
            margin-bottom: 10px;
            background: rgba(25, 5, 48, 0.5);
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
            display: flex;
            align-items: center;
            transition: all 0.2s ease;
        }

        .planet-list li:hover, .sign-list li:hover, .cluster-list li:hover, .feature-list li:hover {
            background: rgba(94, 11, 158, 0.3);
            transform: translateX(5px);
        }

        .sub-list {
            list-style-type: none;
            padding-left: 25px;
            margin: 10px 0;
        }

        .sub-list li {
            padding: 5px 0;
            position: relative;
        }

        .sub-list li::before {
            content: "‚úß";
            color: var(--gold);
            position: absolute;
            left: -20px;
        }

        .form-container {
            position: relative;
            z-index: 5;
        }

        .form-inner {
            background: rgba(25, 5, 48, 0.8);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--light-accent);
        }

        input[type="file"] {
            width: 100%;
            padding: 10px;
            background: rgba(12, 0, 23, 0.6);
            border: 1px solid var(--card-border);
            color: var(--text-color);
            border-radius: 8px;
            cursor: pointer;
        }

        input[type="file"]::file-selector-button {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            margin-right: 15px;
            cursor: pointer;
            transition: background 0.3s;
        }

        input[type="file"]::file-selector-button:hover {
            background: var(--secondary-color);
        }

        .cosmic-btn {
            background: linear-gradient(45deg, var(--secondary-color), var(--accent-color));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.4);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: auto;
        }

        .cosmic-btn:hover {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(155, 89, 182, 0.6);
        }

        .cosmic-btn i {
            margin-right: 8px;
        }

        .error {
            color: var(--error-color);
            background: rgba(255, 62, 94, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
            border-left: 4px solid var(--error-color);
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0 30px;
            background: rgba(12, 0, 23, 0.4);
            border-radius: 10px;
            padding: 15px;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(25, 5, 48, 0.7);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--card-border);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .stat-card i {
            font-size: 2.5rem;
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--light-accent);
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .download-section {
            text-align: center;
            padding: 20px;
        }

        .download-link {
            display: inline-block;
            background: linear-gradient(45deg, var(--dark-accent), var(--secondary-color));
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(74, 20, 140, 0.4);
            margin: 10px;
        }

        .download-link:hover {
            background: linear-gradient(45deg, var(--secondary-color), var(--dark-accent));
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(74, 20, 140, 0.6);
        }

        .download-link i {
            margin-right: 10px;
        }

        .mandala-bg {
            position: absolute;
            width: 800px;
            height: 800px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 800'%3E%3Cg fill='none' stroke='rgba(155,89,182,0.1)' stroke-width='1'%3E%3Ccircle cx='400' cy='400' r='200'/%3E%3Ccircle cx='400' cy='400' r='150'/%3E%3Ccircle cx='400' cy='400' r='100'/%3E%3Ccircle cx='400' cy='400' r='50'/%3E%3Cpath d='M400 200L400 600M200 400L600 400M284 284L516 516M284 516L516 284'/%3E%3Cpath d='M400 200 A200 200 0 0 0 600 400M600 400 A200 200 0 0 0 400 600M400 600 A200 200 0 0 0 200 400M200 400 A200 200 0 0 0 400 200'/%3E%3C/g%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-size: contain;
            opacity: 0.1;
            z-index: -1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: rotate 120s linear infinite;
        }

        @keyframes rotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid rgba(158, 90, 200, 0.2);
        }

        .github-link {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        .github-link:hover {
            color: var(--gold);
        }

        .github-link i {
            margin-right: 5px;
        }

        .progress-indicator {
            height: 4px;
            background: linear-gradient(to right, var(--accent-color), var(--gold), var(--accent-color));
            background-size: 200% 100%;
            animation: progress-animation 2s linear infinite;
            margin: 10px 0;
            border-radius: 2px;
        }

        @keyframes progress-animation {
            0% { background-position: 200% 0; }
            100% { background-position: 0 0; }
        }

        .planet-icon {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            color: #fff;
        }

        .planet-Sun { background: radial-gradient(circle, #ffcc00, #ff6600); }
        .planet-Moon { background: radial-gradient(circle, #f5f5f5, #aaaaaa); }
        .planet-Mercury { background: radial-gradient(circle, #a3a3c2, #516a8a); }
        .planet-Venus { background: radial-gradient(circle, #f0c420, #e07b39); }
        .planet-Mars { background: radial-gradient(circle, #ff4500, #8b0000); }
        .planet-Jupiter { background: radial-gradient(circle, #eaad3a, #b5651d); }
        .planet-Saturn { background: radial-gradient(circle, #c2b280, #7e735f); }
        .planet-Uranus { background: radial-gradient(circle, #5cacee, #4682b4); }
        .planet-Neptune { background: radial-gradient(circle, #5f9ea0, #2f4f4f); }
        .planet-Pluto { background: radial-gradient(circle, #8b4513, #321414); }
        .planet-Rahu { background: radial-gradient(circle, #3a3a3a, #000000); }
        .planet-Ketu { background: radial-gradient(circle, #800080, #2e0e3a); }

        .sign-icon {
            display: inline-block;
            width: 30px;
            height: 30px;
            margin-right: 10px;
            text-align: center;
            line-height: 30px;
            font-size: 1.2rem;
            color: var(--gold);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            h2 {
                font-size: 1.8rem;
            }
            .cosmic-card {
                padding: 20px;
            }
            .dashboard-stats {
                grid-template-columns: 1fr;
            }
            .stat-card {
                margin-bottom: 15px;
            }
            .download-link {
                display: block;
                margin: 10px auto;
                width: fit-content;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }
            h2 {
                font-size: 1.5rem;
            }
            .cosmic-card {
                padding: 15px;
            }
            .cosmic-btn, .download-link {
                padding: 10px 20px;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .zodiac-icon {
            transition: transform 0.3s ease;
        }

        .zodiac-icon:hover {
            transform: rotate(15deg) scale(1.2);
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div class="stars"></div>
    <div class="mandala-bg"></div>
    
    <div class="container">
        <header data-aos="fade-down" data-aos-duration="1000">
            <h1><i class="fas fa-star"></i> Cosmic Vedic Astrology Analyzer <i class="fas fa-moon"></i></h1>
            <p>Uncover celestial patterns and astrological insights in events through the lens of Vedic wisdom</p>
        </header>
     
        <div class="form-container" data-aos="fade-up" data-aos-duration="1000">
            <div class="form-inner">
                <form method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="file"><i class="fas fa-file-upload"></i> Upload CSV file (must include YEAR, MONTH, DAY, HOUR, MINUTE, LATITUDE, LONGITUDE):</label>
                        <input type="file" name="file" accept=".csv" required>
                    </div>
                    <button type="submit" class="cosmic-btn"><i class="fas fa-chart-line"></i> Analyze Events</button>
                </form>
                {% if error %}
                    <div class="error"><i class="fas fa-exclamation-triangle"></i> {{ error }}</div>
                {% endif %}
            </div>
        </div>
   <!-- New Sample Datasets Download Section -->
   <div class="cosmic-card download-section" data-aos="fade-up" data-aos-duration="1000">
    <h2><i class="fas fa-file-download"></i> Download Sample Datasets</h2>
    <p>Explore our sample datasets to test the Cosmic Vedic Astrology Analyzer</p>
    <div class="download-buttons">
        <a href="/download/earthquake_1995-2023.csv" class="download-link pulse" download>
            <i class="fas fa-file-csv"></i> Earthquake 1995-2023
        </a>
        <a href="/download/tsunami_dataset.csv" class="download-link pulse" download>
            <i class="fas fa-file-csv"></i> Tsunami Dataset
        </a>
    </div>
</div>
        {% if results %}
        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000">
            <h2><i class="fas fa-chart-bar"></i> Summary</h2>
            <div class="dashboard-stats">
                <div class="stat-card">
                    <i class="fas fa-calendar-check"></i>
                    <div class="stat-number">{{ results.total_events }}</div>
                    <div class="stat-label">Total Events</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle"></i>
                    <div class="stat-number">{{ results.processed_events }}</div>
                    <div class="stat-label">Processed Events</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-calendar-day"></i>
                    <div class="stat-number">
                        {% if results.updated_dataframe %}
                            {% set min_event = results.updated_dataframe | min(attribute='YEAR') %}
                            {{ min_event.YEAR }}
                        {% else %}
                            N/A
                        {% endif %}
                    </div>
                    <div class="stat-label">Earliest Year</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="stat-number">
                        {% if results.updated_dataframe %}
                            {% set max_event = results.updated_dataframe | max(attribute='YEAR') %}
                            {{ max_event.YEAR }}
                        {% else %}
                            N/A
                        {% endif %}
                    </div>
                    <div class="stat-label">Latest Year</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="summaryChart"></canvas>
            </div>
        </div>

        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="100">
            <h2><i class="fas fa-home"></i> Top Planetary Combinations by House</h2>
            
            <div class="chart-container">
                <canvas id="houseDistributionChart"></canvas>
            </div>
            
            {% for house, combinations in results.house_combinations.items() %}
                <h3><span class="zodiac-symbol">üè†</span> House {{ house }}</h3>
                <ul class="planet-list">
                    {% if combinations %}
                        {% for planets, count in combinations.items() %}
                            <li>
                                <div>
                                    {% for planet in planets %}
                                        <span class="planet-icon planet-{{ planet }}">{{ planet[0] }}</span>
                                    {% endfor %}
                                    {{ planets | join(', ') }}: <strong>{{ count }} events</strong> ({{ (count / results.processed_events * 100) | round(2) }}%)
                                </div>
                            </li>
                        {% endfor %}
                    {% else %}
                        <li>No significant combinations</li>
                    {% endif %}
                </ul>
            {% endfor %}
        </div>

        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="200">
            <h2><i class="fas fa-star-of-david"></i> Zodiac Sign Distribution</h2>
            
            <div class="chart-container">
                <canvas id="zodiacDistributionChart"></canvas>
            </div>
            
            {% for sign_data in results.ai_insights.sign_distribution_sorted %}
                {% if sign_data.total_events > 0 %}
                <h3>
                    <span class="zodiac-icon">
                        {% if sign_data.sign == 'Aries' %}‚ôà
                        {% elif sign_data.sign == 'Taurus' %}‚ôâ
                        {% elif sign_data.sign == 'Gemini' %}‚ôä
                        {% elif sign_data.sign == 'Cancer' %}‚ôã
                        {% elif sign_data.sign == 'Leo' %}‚ôå
                        {% elif sign_data.sign == 'Virgo' %}‚ôç
                        {% elif sign_data.sign == 'Libra' %}‚ôé
                        {% elif sign_data.sign == 'Scorpio' %}‚ôè
                        {% elif sign_data.sign == 'Sagittarius' %}‚ôê
                        {% elif sign_data.sign == 'Capricorn' %}‚ôë
                        {% elif sign_data.sign == 'Aquarius' %}‚ôí
                        {% elif sign_data.sign == 'Pisces' %}‚ôì
                        {% else %}‚úß
                        {% endif %}
                    </span> 
                    {{ sign_data.sign }}: {{ sign_data.percentage }}% of total placements
                </h3>
                <ul class="sign-list">
                    {% for planet in sign_data.planets %}
                        <li>
                            <span class="planet-icon planet-{{ planet.planet }}">{{ planet.planet[0] }}</span>
                            {{ planet.planet }}: {{ planet.events }} events ({{ planet.percentage_in_sign }}% of {{ sign_data.sign }})
                        </li>
                    {% endfor %}
                </ul>
                {% endif %}
            {% endfor %}
        </div>

        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="300">
            <h2><i class="fas fa-om"></i> Vedic Yogas</h2>
            
            <div class="chart-container">
                <canvas id="yogaChart"></canvas>
            </div>
            
            {% if results.yoga_patterns %}
                <ul class="planet-list">
                    {% for yoga in results.yoga_patterns %}
                        <li>
                            <i class="fas fa-dharmachakra zodiac-symbol"></i>
                            {{ yoga.yoga }}: <strong>{{ yoga.count }} events</strong> ({{ yoga.percentage }}%)
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No significant yogas identified</p>
            {% endif %}
        </div>

        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="400">
            <h2><i class="fas fa-project-diagram"></i> Aspect Patterns</h2>
            
            <div class="chart-container">
                <canvas id="aspectChart"></canvas>
            </div>
            
            {% if results.aspect_patterns %}
                <ul class="planet-list">
                    {% for aspect in results.aspect_patterns %}
                        <li>
                            <i class="fas fa-angle-double-right zodiac-symbol"></i>
                            {% for planet in aspect.planets %}
                                <span class="planet-icon planet-{{ planet }}">{{ planet[0] }}</span>
                            {% endfor %}
                            {{ aspect.planets | join(' - ') }} ({{ aspect.aspect }}): <strong>{{ aspect.count }} occurrences</strong>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No significant aspect patterns identified</p>
            {% endif %}
        </div>

        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="500">
            <h2><i class="fas fa-brain"></i> AI Pattern Analysis</h2>
            
            <h3><i class="fas fa-object-group"></i> Event Clusters</h3>
            {% if results.ai_insights.clusters %}
                <div class="chart-container">
                    <canvas id="clusterChart"></canvas>
                </div>
                
                <ul class="cluster-list">
                    {% for cluster in results.ai_insights.clusters %}
                        <li>
                            <div><strong>Cluster {{ cluster.cluster_id }}</strong> ({{ cluster.size }} events, {{ cluster.percentage }}%)</div>
                            <ul class="sub-list">
                                <li><strong>Dominant Signs:</strong> {{ cluster.dominant_signs | join(', ') }}</li>
                                <li><strong>Dominant Houses:</strong> {{ cluster.dominant_houses | join(', ') }}</li>
                                <li><strong>Dominant Aspects:</strong> {{ cluster.dominant_aspects | join(', ') }}</li>
                                <li><strong>House Planet Distribution:</strong>
                                    <ul class="sub-list">
                                        {% for house, planets in cluster.house_planet_distribution.items() %}
                                            <li>House {{ house }}:
                                                <ul class="sub-list">
                                                    {% for planet in planets %}
                                                        <li>{{ planet.planet }}: {{ planet.count }} events</li>
                                                    {% endfor %}
                                                </ul>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No clusters identified</p>
            {% endif %}

            <h3><i class="fas fa-chart-pie"></i> Key Influential Factors</h3>
            {% if results.ai_insights.important_features %}
                <!-- <div class="chart-container">
                    <canvas id="featuresChart"></canvas>
                </div>
                 -->
                <ul class="feature-list">
                    {% for feature in results.ai_insights.important_features %}
                        <li>
                            <i class="fas fa-key zodiac-symbol"></i>
                            {{ feature.feature }}: <strong>{{ (feature.importance * 100) | round(2) }}% importance</strong>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No significant factors identified</p>
            {% endif %}

            <h3><i class="fas fa-link"></i> Correlations</h3>
            {% if results.ai_insights.correlations %}
                <!-- <div class="chart-container">
                    <canvas id="correlationChart"></canvas>
                </div> -->
                
                <ul class="feature-list">
                    {% for corr in results.ai_insights.correlations %}
                        <li>
                            <i class="fas fa-exchange-alt zodiac-symbol"></i>
                            {{ corr.feature1 }} and {{ corr.feature2 }}: <strong>{{ corr.correlation | round(3) }}</strong>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No significant correlations identified</p>
            {% endif %}

            <h3><i class="fas fa-network-wired"></i> Network Analysis</h3>
            {% if results.ai_insights.network_analysis %}
                <!-- <div class="chart-container">
                    <canvas id="networkChart"></canvas>
                </div> -->
                
                <p><strong>Most Connected Planets:</strong></p>
                <ul class="feature-list">
                    {% for planet, centrality in results.ai_insights.network_analysis.most_connected_planets %}
                        <li>
                            <span class="planet-icon planet-{{ planet }}">{{ planet[0] }}</span>
                            {{ planet }}: <strong>{{ (centrality * 100) | round(2) }}% centrality</strong>
                        </li>
                    {% endfor %}
                </ul>
                <p><strong>Strongest Aspects:</strong></p>
                <ul class="feature-list">
                    {% for aspect, planet1, planet2, weight in results.ai_insights.network_analysis.strongest_aspects %}
                        <li>
                            <span class="planet-icon planet-{{ planet1 }}">{{ planet1[0] }}</span>
                            <span class="planet-icon planet-{{ planet2 }}">{{ planet2[0] }}</span>
                            {{ planet1 }} - {{ planet2 }} ({{ aspect }}): <strong>{{ weight }} occurrences</strong>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No significant network patterns identified</p>
            {% endif %}
        </div>

        {% if results.ai_insights.category_insights %}
        <div class="cosmic-card" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="600">
            <h2><i class="fas fa-layer-group"></i> Category-Specific Insights</h2>
            
            <!-- <div class="chart-container">
                <canvas id="categoryChart"></canvas>
            </div> -->
            
            {% for insight in results.ai_insights.category_insights %}
                <h3><i class="fas fa-tag"></i> {{ insight.category }} ({{ insight.count }} events, {{ insight.percentage }}%)</h3>
                <p><strong>Top Planets:</strong></p>
                <ul class="planet-list">
                    {% for planet in insight.top_planets %}
                        <li>
                            <span class="planet-icon planet-{{ planet.planet }}">{{ planet.planet[0] }}</span>
                            {{ planet.planet }} in {{ planet.sign }}: <strong>{{ planet.count }} occurrences</strong>
                        </li>
                    {% endfor %}
                </ul>
                <p><strong>Top Houses:</strong></p>
                <ul class="planet-list">
                    {% for house in insight.top_houses %}
                        <li>
                            <i class="fas fa-home zodiac-symbol"></i>
                            House {{ house.house }}: <strong>{{ house.count }} planets</strong>
                        </li>
                    {% endfor %}
                </ul>
            {% endfor %}
        </div>
        {% endif %}

        <div class="cosmic-card download-section" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="700">
            <h2><i class="fas fa-download"></i> Download Results</h2>
            <p>Download your complete analysis results for offline reference and further study</p>
            <a href="/download" class="download-link pulse"><i class="fas fa-file-download"></i> Download Updated CSV</a>
        </div>
        {% endif %}

        <footer>
            <p>Created with cosmic wisdom and divine inspiration</p>
            <p>Explore more stellar projects at <a href="https://github.com/ishanoshada" class="github-link"><i class="fab fa-github"></i>github.com/ishanoshada/</a></p>
            <p>Repo <a href="https://github.com/ishanoshada/sample" class="github-link"><i class="fab fa-github"></i>github.com/ishanoshada/sample</a></p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>
        // Initialize AOS Animation
        document.addEventListener('DOMContentLoaded', function() {
            AOS.init();
            
            // Initialize particles.js
            particlesJS('particles-js', {
                "particles": {
                    "number": {
                        "value": 80,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": ["#9b59b6", "#8e44ad", "#6a1b9a"]
                    },
                    "shape": {
                        "type": ["circle", "star"],
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        },
                    },
                    "opacity": {
                        "value": 0.5,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 3,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 2,
                            "size_min": 0.1,
                            "sync": false
                        }
                    },
                    "line_linked": {
                        "enable": true,
                        "distance": 150,
                        "color": "#9b59b6",
                        "opacity": 0.2,
                        "width": 1
                    },
                    "move": {
                        "enable": true,
                        "speed": 1,
                        "direction": "none",
                        "random": true,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": true,
                            "rotateX": 600,
                            "rotateY": 1200
                        }
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": true,
                            "mode": "grab"
                        },
                        "onclick": {
                            "enable": true,
                            "mode": "push"
                        },
                        "resize": true
                    },
                    "modes": {
                        "grab": {
                            "distance": 140,
                            "line_linked": {
                                "opacity": 0.8
                            }
                        },
                        "push": {
                            "particles_nb": 3
                        }
                    }
                },
                "retina_detect": true
            });
        });

        {% if results %}
        // Charts
        document.addEventListener('DOMContentLoaded', function() {
            // Chart.js Global Configuration
            Chart.defaults.color = '#cbb9d9';
            Chart.defaults.font.family = "'Rajdhani', sans-serif";
            Chart.defaults.scale.grid.color = 'rgba(203, 185, 217, 0.1)';
            Chart.defaults.plugins.legend.labels.padding = 20;
            
            // Summary Chart - Event Distribution Over Time
            const summaryCtx = document.getElementById('summaryChart').getContext('2d');
            new Chart(summaryCtx, {
                type: 'line',
                data: {
                    labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                    datasets: [{
                        label: 'Event Distribution',
                        data: [12, 19, 3, 5, 8, 3, 7, 14, 9, 12, 4, 6],
                        fill: true,
                        backgroundColor: 'rgba(155, 89, 182, 0.3)',
                        borderColor: '#9b59b6',
                        borderWidth: 2,
                        pointBackgroundColor: '#ffd700',
                        pointBorderColor: '#5e0b9e',
                        pointHoverBackgroundColor: '#e1bee7',
                        pointHoverBorderColor: '#4a148c',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Event Distribution Throughout the Year',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // House Distribution Chart
            const houseCtx = document.getElementById('houseDistributionChart').getContext('2d');
            new Chart(houseCtx, {
                type: 'bar',
                data: {
                    labels: ['House 1', 'House 2', 'House 3', 'House 4', 'House 5', 'House 6', 'House 7', 'House 8', 'House 9', 'House 10', 'House 11', 'House 12'],
                    datasets: [{
                        label: 'Planetary Placements',
                        data: [12, 19, 3, 5, 8, 3, 7, 14, 9, 12, 4, 6],
                        backgroundColor: [
                            'rgba(155, 89, 182, 0.7)',
                            'rgba(94, 11, 158, 0.7)',
                            'rgba(225, 190, 231, 0.7)',
                            'rgba(74, 20, 140, 0.7)',
                            'rgba(155, 89, 182, 0.7)',
                            'rgba(94, 11, 158, 0.7)',
                            'rgba(225, 190, 231, 0.7)',
                            'rgba(74, 20, 140, 0.7)',
                            'rgba(155, 89, 182, 0.7)',
                            'rgba(94, 11, 158, 0.7)',
                            'rgba(225, 190, 231, 0.7)',
                            'rgba(74, 20, 140, 0.7)'
                        ],
                        borderColor: 'rgba(255, 215, 0, 0.6)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Distribution of Planetary Placements by House',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Zodiac Distribution Chart
            const zodiacCtx = document.getElementById('zodiacDistributionChart').getContext('2d');
            new Chart(zodiacCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces'],
                    datasets: [{
                        label: 'Sign Distribution',
                        data: [12, 19, 3, 5, 8, 3, 7, 14, 9, 12, 4, 6],
                        backgroundColor: [
                            '#FF5733', // Aries
                            '#67B7D1', // Taurus
                            '#FFCE30', // Gemini
                            '#6B5B95', // Cancer
                            '#FF8C00', // Leo
                            '#88B04B', // Virgo
                            '#EFC050', // Libra
                            '#7B3F00', // Scorpio
                            '#6F2DA8', // Sagittarius
                            '#45B8AC', // Capricorn
                            '#5B5EA6', // Aquarius
                            '#9B2335'  // Pisces
                        ],
                        borderColor: 'rgba(25, 5, 48, 0.8)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 10
                            }
                        },
                        title: {
                            display: true,
                            text: 'Zodiac Sign Distribution',
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            });
            
            // Yoga Chart
            const yogaCtx = document.getElementById('yogaChart').getContext('2d');
            new Chart(yogaCtx, {
                type: 'polarArea',
                data: {
                    labels: ['Raja Yoga', 'Dhana Yoga', 'Gajakesari Yoga', 'Budhaditya Yoga', 'Chandra Mangala Yoga'],
                    datasets: [{
                        label: 'Yoga Occurrences',
                        data: [8, 12, 5, 7, 4],
                        backgroundColor: [
                            'rgba(155, 89, 182, 0.7)',
                            'rgba(94, 11, 158, 0.7)',
                            'rgba(225, 190, 231, 0.7)',
                            'rgba(74, 20, 140, 0.7)',
                            'rgba(45, 13, 87, 0.7)'
                        ],
                        borderColor: 'rgba(255, 215, 0, 0.6)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 10
                            }
                        },
                        title: {
                            display: true,
                            text: 'Vedic Yoga Distribution',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        r: {
                            ticks: {
                                backdropColor: 'rgba(0, 0, 0, 0)'
                            }
                        }
                    }
                }
            });
            
            // Aspect Chart
            const aspectCtx = document.getElementById('aspectChart').getContext('2d');
            new Chart(aspectCtx, {
                type: 'radar',
                data: {
                    labels: ['Conjunction', 'Opposition', 'Trine', 'Square', 'Sextile'],
                    datasets: [{
                        label: 'Aspect Frequency',
                        data: [15, 9, 12, 7, 8],
                        backgroundColor: 'rgba(155, 89, 182, 0.3)',
                        borderColor: '#9b59b6',
                        borderWidth: 2,
                        pointBackgroundColor: '#ffd700',
                        pointBorderColor: '#5e0b9e',
                        pointHoverBackgroundColor: '#e1bee7',
                        pointHoverBorderColor: '#4a148c'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Aspect Type Distribution',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            angleLines: {
                                color: 'rgba(203, 185, 217, 0.2)',
                            },
                            grid: {
                                color: 'rgba(203, 185, 217, 0.2)',
                            },
                            ticks: {
                                backdropColor: 'rgba(0, 0, 0, 0)'
                            }
                        }
                    }
                }
            });
            
            // Cluster Chart
            const clusterCtx = document.getElementById('clusterChart').getContext('2d');
            new Chart(clusterCtx, {
                type: 'pie',
                data: {
                    labels: ['Cluster 1', 'Cluster 2', 'Cluster 3', 'Cluster 4'],
                    datasets: [{
                        label: 'Event Distribution',
                        data: [25, 18, 12, 15],
                        backgroundColor: [
                            'rgba(155, 89, 182, 0.7)',
                            'rgba(94, 11, 158, 0.7)',
                            'rgba(225, 190, 231, 0.7)',
                            'rgba(74, 20, 140, 0.7)'
                        ],
                        borderColor: 'rgba(255, 215, 0, 0.6)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 10
                            }
                        },
                        title: {
                            display: true,
                            text: 'Event Cluster Distribution',
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            });
            
      
        });
        {% endif %}
    </script>
</body>
</html>